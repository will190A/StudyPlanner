(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{7021:function(e,t,r){Promise.resolve().then(r.bind(r,4995))},4995:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var n=r(7437),s=r(2265),a=r(605),o=r(9376),i=r(1229),l=r(3590),c=r(9501),d=r(7648),u=r(8752),f=r(2381),m=r(9820),x=r(670),p=r(279);let h=i.z.object({email:i.z.string().email({message:"请输入有效的邮箱地址"}),password:i.z.string().min(1,{message:"请输入密码"})});function g(e){let{onRegisterSuccess:t}=e,r=(0,o.useSearchParams)();return(0,s.useEffect)(()=>{(null==r?void 0:r.get("registered"))==="true"&&t(!0)},[r,t]),null}function v(){let e=(0,o.useRouter)(),[t,r]=(0,s.useState)(!1),[i,v]=(0,s.useState)(""),{toast:j}=(0,u.p)(),[y,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{y&&j({title:"注册成功",description:"请使用您的邮箱和密码登录",duration:5e3})},[y,j]);let N=(0,c.cI)({resolver:(0,l.F)(h),defaultValues:{email:"",password:""}});async function S(t){r(!0),v("");try{let r="/home";{let e=localStorage.getItem("redirectAfterLogin");e&&(r=e,localStorage.removeItem("redirectAfterLogin"))}console.log("[LoginPage] 尝试登录，登录后将重定向到: ".concat(r));let n=await (0,a.signIn)("credentials",{email:t.email,password:t.password,redirect:!1});(null==n?void 0:n.error)?(console.error("[LoginPage] 登录失败: ".concat(n.error)),v("邮箱或密码错误")):(console.log("[LoginPage] 登录成功，重定向到: ".concat(r)),e.push(decodeURIComponent(r)),e.refresh())}catch(e){console.error("[LoginPage] 登录异常:",e),v("登录时出现错误，请稍后再试")}finally{r(!1)}}return(0,n.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,n.jsx)(s.Suspense,{fallback:null,children:(0,n.jsx)(g,{onRegisterSuccess:b})}),(0,n.jsxs)(m.Zb,{className:"w-[450px]",children:[(0,n.jsxs)(m.Ol,{className:"space-y-1",children:[(0,n.jsx)(m.ll,{className:"text-2xl font-bold",children:"登录"}),(0,n.jsx)(m.SZ,{children:"输入您的邮箱和密码登录"})]}),(0,n.jsx)(m.aY,{children:(0,n.jsx)(x.l0,{...N,children:(0,n.jsxs)("form",{onSubmit:N.handleSubmit(S),className:"space-y-4",children:[(0,n.jsx)(x.Wi,{control:N.control,name:"email",render:e=>{let{field:t}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"邮箱"}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(p.I,{placeholder:"your.email@example.com",...t})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:N.control,name:"password",render:e=>{let{field:t}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"密码"}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(p.I,{type:"password",placeholder:"******",...t})}),(0,n.jsx)(x.zG,{}),(0,n.jsx)("div",{className:"text-sm text-right",children:(0,n.jsx)(d.default,{href:"/forgot-password",className:"text-primary hover:underline",children:"忘记密码?"})})]})}}),i&&(0,n.jsx)("div",{className:"text-sm font-medium text-destructive",children:i}),(0,n.jsx)(f.z,{type:"submit",className:"w-full",disabled:t,children:t?"登录中...":"登录"})]})})}),(0,n.jsx)(m.eW,{className:"flex justify-center",children:(0,n.jsxs)("div",{className:"text-sm text-center",children:["没有账号？"," ",(0,n.jsx)(d.default,{href:"/register",className:"text-primary underline-offset-4 hover:underline",children:"注册"})]})})]})]})}},2381:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return c}});var n=r(7437),s=r(2265),a=r(7053),o=r(535),i=r(3448);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(l({variant:s,size:o,className:r})),ref:t,...d})});c.displayName="Button"},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return o},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var n=r(7437),s=r(2265),a=r(3448);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},670:function(e,t,r){"use strict";r.d(t,{NI:function(){return h},Wi:function(){return u},l0:function(){return c},lX:function(){return p},xJ:function(){return x},zG:function(){return g}});var n=r(7437),s=r(2265),a=r(7053),o=r(9501),i=r(3448),l=r(5060);let c=o.RV,d=s.createContext({}),u=e=>{let{...t}=e;return(0,n.jsx)(d.Provider,{value:{name:t.name},children:(0,n.jsx)(o.Qr,{...t})})},f=()=>{let e=s.useContext(d),t=s.useContext(m),{getFieldState:r,formState:n}=(0,o.Gc)(),a=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...a}},m=s.createContext({}),x=s.forwardRef((e,t)=>{let{className:r,...a}=e,o=s.useId();return(0,n.jsx)(m.Provider,{value:{id:o},children:(0,n.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",r),...a})})});x.displayName="FormItem";let p=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:a,formItemId:o}=f();return(0,n.jsx)(l._,{ref:t,className:(0,i.cn)(a&&"text-destructive",r),htmlFor:o,...s})});p.displayName="FormLabel";let h=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:o,formDescriptionId:i,formMessageId:l}=f();return(0,n.jsx)(a.g7,{ref:t,id:o,"aria-describedby":s?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!s,...r})});h.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:a}=f();return(0,n.jsx)("p",{ref:t,id:a,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})}).displayName="FormDescription";let g=s.forwardRef((e,t)=>{let{className:r,children:s,...a}=e,{error:o,formMessageId:l}=f(),c=o?String(null==o?void 0:o.message):s;return c?(0,n.jsx)("p",{ref:t,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",r),...a,children:c}):null});g.displayName="FormMessage"},279:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var n=r(7437),s=r(2265),a=r(3448);let o=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,n.jsx)("input",{type:s,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},5060:function(e,t,r){"use strict";r.d(t,{_:function(){return c}});var n=r(7437),s=r(2265),a=r(6394),o=r(535),i=r(3448);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(a.f,{ref:t,className:(0,i.cn)(l(),r),...s})});c.displayName=a.f.displayName},8752:function(e,t,r){"use strict";r.d(t,{p:function(){return d}});var n=r(2265);let s={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"},a=0,o=new Map,i={toasts:[]},l=[];function c(e){i.toasts=function(e,t){switch(t.type){case s.ADD_TOAST:return[t.toast,...e].slice(0,1);case s.UPDATE_TOAST:return e.map(e=>e.id===t.toast.id?{...e,...t.toast}:e);case s.DISMISS_TOAST:{let{toastId:r}=t;return o.has(r)&&(clearTimeout(o.get(r)),o.delete(r)),e.map(e=>e.id===r?{...e,open:!1}:e)}case s.REMOVE_TOAST:return e.filter(e=>e.id!==t.toastId);default:return e}}(i.toasts,e),l.forEach(e=>{e(i)})}function d(){let[e,t]=(0,n.useState)(i);return(0,n.useEffect)(()=>(l.push(t),()=>{l=l.filter(e=>e!==t)}),[]),{...e,toast:e=>{let t=(a=(a+1)%Number.MAX_VALUE).toString(),r=()=>c({type:s.DISMISS_TOAST,toastId:t});return c({type:s.ADD_TOAST,toast:{...e,id:t,open:!0,onOpenChange:e=>{e||r()}}}),e.duration&&setTimeout(r,e.duration),{id:t,dismiss:r,update:e=>c({type:s.UPDATE_TOAST,toast:{...e,id:t}})}},dismiss:e=>c({type:s.DISMISS_TOAST,toastId:e})}}},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(1994),s=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}}},function(e){e.O(0,[265,972,605,970,971,117,744],function(){return e(e.s=7021)}),_N_E=e.O()}]);