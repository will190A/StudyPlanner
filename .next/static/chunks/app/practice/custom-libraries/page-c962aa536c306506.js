(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[463],{5583:function(e,t,s){Promise.resolve().then(s.bind(s,1416))},1416:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(7437),r=s(2265),n=s(9376),l=s(605),i=s(7325),d=s(9820),o=s(2381),c=s(279),m=s(5937),u=s(714),f=s(2489),x=s(3448);let h=u.fC;u.xz;let p=e=>{let{...t}=e;return(0,a.jsx)(u.h_,{...t})};p.displayName=u.h_.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.aV,{ref:t,className:(0,x.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});g.displayName=u.aV.displayName;let v=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(p,{children:[(0,a.jsx)(g,{}),(0,a.jsxs)(u.VY,{ref:t,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",s),...n,children:[r,(0,a.jsxs)(u.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});v.displayName=u.VY.displayName;let j=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-1.5 text-left",t),...s})};j.displayName="DialogHeader";let N=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,x.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};N.displayName="DialogFooter";let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.Dx,{ref:t,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});y.displayName=u.Dx.displayName;let b=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.dk,{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",s),...r})});b.displayName=u.dk.displayName;var w=s(3247),k=s(4760),C=s(5863),z=s(2624),R=s(8930),Z=s(3276),S=s(1769);function E(){let e=(0,n.useRouter)(),{data:t}=(0,l.useSession)(),[s,u]=(0,r.useState)([]),[f,x]=(0,r.useState)(!0),[p,g]=(0,r.useState)(""),[E,_]=(0,r.useState)(""),[D,O]=(0,r.useState)(null),[V,A]=(0,r.useState)(!1),I=()=>(null==t?void 0:t.user)&&"id"in t.user?t.user.id:"6804c5d6112eb76d7c0ec957";(0,r.useEffect)(()=>{T()},[t]);let T=async()=>{try{x(!0),g("");let e=I(),t=await fetch("/api/questions/custom?userId=".concat(e));if(!t.ok)throw Error("获取题库失败");let s=await t.json();u(s.libraries||[])}catch(e){console.error("获取题库错误:",e),g(e.message||"获取题库失败，请重试")}finally{x(!1)}},L=async(t,s)=>{try{x(!0);let t=I(),a=await fetch("/api/practices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"custom",libraryName:s,title:"".concat(s," 练习"),count:0,userId:t})});if(!a.ok)throw Error("创建练习失败");let r=await a.json();e.push("/practice/".concat(r.practice._id))}catch(e){console.error("创建练习错误:",e),g("创建练习失败，请重试"),x(!1)}},P=async()=>{if(D)try{if(x(!0),!(await fetch("/api/questions/custom/".concat(D.id,"?name=").concat(encodeURIComponent(D.name)),{method:"DELETE"})).ok)throw Error("删除题库失败");A(!1),await T()}catch(e){console.error("删除题库错误:",e),g(e.message||"删除题库失败，请重试")}finally{x(!1)}},Y=s.filter(e=>e.name.toLowerCase().includes(E.toLowerCase()));return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(i.default,{}),(0,a.jsx)("main",{className:"pt-16",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"自定义题库"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"管理您通过智能导题创建的自定义题库"})]}),(0,a.jsxs)("div",{className:"mt-4 md:mt-0 flex items-center",children:[(0,a.jsxs)("div",{className:"relative w-full md:w-64",children:[(0,a.jsx)(w.Z,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(c.I,{placeholder:"搜索题库...",className:"pl-8",value:E,onChange:e=>_(e.target.value)})]}),(0,a.jsxs)(o.z,{className:"ml-2 bg-purple-600 hover:bg-purple-700",onClick:()=>e.push("/practice/smart-import"),children:[(0,a.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"创建题库"]})]})]}),p&&(0,a.jsx)(m.bZ,{variant:"destructive",className:"mb-6",children:(0,a.jsx)(m.X,{children:p})}),f?(0,a.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,a.jsx)(C.Z,{className:"h-8 w-8 animate-spin text-gray-400"}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"正在加载题库..."})]}):Y.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Y.map(e=>{var t;return(0,a.jsxs)(d.Zb,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[(0,a.jsx)(d.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ll,{children:e.name}),(0,a.jsxs)(d.SZ,{className:"mt-1",children:[e.questionCount||0," 道题目 \xb7 ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:(0,a.jsx)(z.Z,{className:"h-5 w-5 text-purple-600"})})]})}),(0,a.jsx)(d.aY,{className:"pb-2",children:(0,a.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description||"包含".concat((null===(t=e.categories)||void 0===t?void 0:t.join("、"))||"多个类型","的题目")})}),(0,a.jsxs)(d.eW,{className:"flex justify-between pt-2",children:[(0,a.jsxs)(o.z,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{O(e),A(!0)},children:[(0,a.jsx)(R.Z,{className:"h-4 w-4 mr-1"}),"删除"]}),(0,a.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>L(e.id,e.name),disabled:f,children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4 mr-1"}),"开始练习"]})]})]},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:[(0,a.jsx)(S.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:E?"没有找到匹配的题库":"还没有创建自定义题库"}),(0,a.jsx)("p",{className:"mt-1 text-gray-500",children:E?"尝试使用其他关键词搜索":"使用智能导题功能创建您的第一个自定义题库"}),!E&&(0,a.jsxs)(o.z,{className:"mt-4 bg-purple-600 hover:bg-purple-700",onClick:()=>e.push("/practice/smart-import"),children:[(0,a.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"开始创建题库"]})]})]})}),(0,a.jsx)(h,{open:V,onOpenChange:A,children:(0,a.jsxs)(v,{children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(y,{children:"确认删除题库"}),(0,a.jsxs)(b,{children:['您确定要删除题库 "',null==D?void 0:D.name,'" 吗？此操作无法撤销。']})]}),(0,a.jsxs)(N,{children:[(0,a.jsx)(o.z,{variant:"outline",onClick:()=>A(!1),children:"取消"}),(0,a.jsxs)(o.z,{variant:"destructive",onClick:P,disabled:f,children:[f?(0,a.jsx)(C.Z,{className:"h-4 w-4 animate-spin mr-2"}):(0,a.jsx)(R.Z,{className:"h-4 w-4 mr-2"}),"确认删除"]})]})]})})]})}},7325:function(e,t,s){"use strict";var a=s(7437),r=s(7648),n=s(9376),l=s(3448),i=s(605),d=s(2369);t.default=()=>{let e=(0,n.usePathname)(),t=(0,n.useRouter)(),{data:s}=(0,i.useSession)();return(0,a.jsx)("nav",{className:"fixed top-0 left-0 right-0 bg-white border-b z-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,a.jsx)(r.default,{href:"/home",className:"text-xl font-bold text-gray-900",children:"StudyPlanner"})}),(0,a.jsx)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[{name:"首页",href:"/home"},{name:"学习计划",href:"/plans"},{name:"题库练习",href:"/practice"},{name:"学习报告",href:"/reports"}].map(t=>(0,a.jsx)(r.default,{href:t.href,className:(0,l.cn)("inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",e===t.href?"border-indigo-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:t.name},t.href))})]}),(0,a.jsx)("div",{className:"hidden sm:ml-6 sm:flex sm:items-center",children:(null==s?void 0:s.user)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center mr-4",children:[(0,a.jsx)("div",{className:"flex items-center rounded-full bg-indigo-100 text-indigo-800 p-2 mr-2",children:(0,a.jsx)(d.Z,{size:18})}),(0,a.jsx)("span",{className:"text-gray-700 font-medium",children:s.user.name||"用户"})]}),(0,a.jsx)("button",{onClick:()=>{t.push("/force-logout")},className:"text-gray-500 hover:text-gray-700 border border-gray-300 px-3 py-1.5 rounded-md text-sm font-medium",children:"退出登录"})]}):(0,a.jsx)(r.default,{href:"/login",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"登录"})})]})})})}},5937:function(e,t,s){"use strict";s.d(t,{X:function(){return o},bZ:function(){return d}});var a=s(7437),r=s(2265),n=s(535),l=s(3448);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(i({variant:r}),s),...n})});d.displayName="Alert",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})}).displayName="AlertTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",s),...r})});o.displayName="AlertDescription"},2381:function(e,t,s){"use strict";s.d(t,{d:function(){return d},z:function(){return o}});var a=s(7437),r=s(2265),n=s(7053),l=s(535),i=s(3448);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:o=!1,...c}=e,m=o?n.g7:"button";return(0,a.jsx)(m,{className:(0,i.cn)(d({variant:r,size:l,className:s})),ref:t,...c})});o.displayName="Button"},9820:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return l},aY:function(){return c},eW:function(){return m},ll:function(){return d}});var a=s(7437),r=s(2265),n=s(3448);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});m.displayName="CardFooter"},279:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var a=s(7437),r=s(2265),n=s(3448);let l=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})});l.displayName="Input"},3448:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(1994),r=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[265,972,605,846,351,95,971,117,744],function(){return e(e.s=5583)}),_N_E=e.O()}]);