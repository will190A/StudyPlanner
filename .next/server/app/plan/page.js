(()=>{var e={};e.id=1927,e.ids=[1927],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},31699:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>o}),t(11475),t(83336),t(35866);var a=t(23191),s=t(88716),n=t(37922),l=t.n(n),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(r,d);let o=["",{children:["plan",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,11475)),"D:\\武欣宇\\大三下\\计算机设计大赛\\StudyPlanner2\\src\\app\\plan\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,83336)),"D:\\武欣宇\\大三下\\计算机设计大赛\\StudyPlanner2\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\武欣宇\\大三下\\计算机设计大赛\\StudyPlanner2\\src\\app\\plan\\page.tsx"],u="/plan/page",p={require:t,loadChunk:()=>Promise.resolve()},f=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/plan/page",pathname:"/plan",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},46193:(e,r,t)=>{Promise.resolve().then(t.bind(t,64368))},32933:(e,r,t)=>{"use strict";t.d(r,{Z:()=>a});let a=(0,t(76557).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},75290:(e,r,t)=>{"use strict";t.d(r,{Z:()=>a});let a=(0,t(76557).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},64368:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(10326),s=t(17577),n=t(35047),l=t(96040),i=t(77109),d=t(91664),o=t(29752),c=t(94880),u=t(9280),p=t(33261),f=t(75290);function x({onPlanIdReceived:e}){return e((0,n.useSearchParams)().get("id")),null}function m(){let e=(0,n.useRouter)(),{data:r,status:t}=(0,i.useSession)(),{currentPlan:m,updateTask:h,deletePlan:v,isLoading:g,error:b,fetchPlans:j}=(0,l.W)(),[y,N]=(0,s.useState)(null),[w,k]=(0,s.useState)(!1),[P,R]=(0,s.useState)(!0),C=async(e,r)=>{if(!m){console.error("No current plan found");return}if(!(m._id||m.id)){console.error("Plan ID is missing");return}try{let t=await h(e,r);t.success||console.error("Failed to update task:",t.error)}catch(e){console.error("Error updating task:",e)}},S=async()=>{if(m&&confirm("确定要删除这个学习计划吗？")){k(!0);try{let r=await v(m.id);r.success?e.push("/plans"):console.error("Failed to delete plan:",r.error)}finally{k(!1)}}};if(P)return(0,a.jsxs)("div",{className:"flex justify-center items-center min-h-screen",children:[a.jsx(s.Suspense,{fallback:null,children:a.jsx(x,{onPlanIdReceived:N})}),a.jsx(f.Z,{className:"h-8 w-8 animate-spin"})]});if(!m)return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[a.jsx(s.Suspense,{fallback:null,children:a.jsx(x,{onPlanIdReceived:N})}),(0,a.jsxs)(o.Zb,{children:[a.jsx(o.Ol,{children:a.jsx(o.ll,{children:"没有找到学习计划"})}),(0,a.jsxs)(o.aY,{children:[a.jsx("p",{children:"请选择一个现有的计划。"}),a.jsx(d.z,{onClick:()=>e.push("/plans"),className:"mt-4",children:"返回计划列表"})]})]})]});let D=m.tasks.length,E=m.tasks.filter(e=>e.completed).length,_=D>0?E/D*100:0,z=m.tasks.reduce((e,r)=>(e[r.date]||(e[r.date]=[]),e[r.date].push(r),e),{});return(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[a.jsx(s.Suspense,{fallback:null,children:a.jsx(x,{onPlanIdReceived:N})}),b&&a.jsx(p.bZ,{variant:"destructive",className:"mb-4",children:a.jsx(p.X,{children:b})}),(0,a.jsxs)(o.Zb,{className:"mb-6",children:[a.jsx(o.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx(o.ll,{children:"学习计划进度"}),a.jsx(d.z,{variant:"destructive",onClick:S,disabled:w,children:w?(0,a.jsxs)(a.Fragment,{children:[a.jsx(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"删除中..."]}):"删除计划"})]})}),a.jsx(o.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"总体进度"}),(0,a.jsxs)("span",{children:[Math.round(_),"%"]})]}),a.jsx(c.E,{value:_,className:"h-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"总任务数"}),a.jsx("p",{className:"text-2xl font-bold",children:D})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"已完成任务"}),a.jsx("p",{className:"text-2xl font-bold",children:E})]})]})]})})]}),a.jsx("div",{className:"space-y-6",children:Object.entries(z).sort(([e],[r])=>new Date(e).getTime()-new Date(r).getTime()).map(([e,r])=>(0,a.jsxs)(o.Zb,{children:[a.jsx(o.Ol,{children:a.jsx(o.ll,{children:new Date(e).toLocaleDateString()})}),a.jsx(o.aY,{children:a.jsx("div",{className:"space-y-4",children:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[a.jsx(u.X,{id:e.id,checked:e.completed,onCheckedChange:r=>C(e.id,r),disabled:g}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("label",{htmlFor:e.id,className:`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${e.completed?"line-through text-gray-500":""}`,children:[e.subject," - ",e.description]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["预计时长: ",e.duration," 小时"]})]})]},e.id))})})]},e))})]})}},33261:(e,r,t)=>{"use strict";t.d(r,{X:()=>o,bZ:()=>d});var a=t(10326),s=t(17577),n=t(79360),l=t(51223);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=s.forwardRef(({className:e,variant:r,...t},s)=>a.jsx("div",{ref:s,role:"alert",className:(0,l.cn)(i({variant:r}),e),...t}));d.displayName="Alert",s.forwardRef(({className:e,...r},t)=>a.jsx("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...r})).displayName="AlertTitle";let o=s.forwardRef(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...r}));o.displayName="AlertDescription"},91664:(e,r,t)=>{"use strict";t.d(r,{d:()=>d,z:()=>o});var a=t(10326),s=t(17577),n=t(34214),l=t(79360),i=t(51223);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef(({className:e,variant:r,size:t,asChild:s=!1,...l},o)=>{let c=s?n.g7:"button";return a.jsx(c,{className:(0,i.cn)(d({variant:r,size:t,className:e})),ref:o,...l})});o.displayName="Button"},29752:(e,r,t)=>{"use strict";t.d(r,{Ol:()=>i,SZ:()=>o,Zb:()=>l,aY:()=>c,eW:()=>u,ll:()=>d});var a=t(10326),s=t(17577),n=t(51223);let l=s.forwardRef(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...r}));l.displayName="Card";let i=s.forwardRef(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let d=s.forwardRef(({className:e,...r},t)=>a.jsx("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...r}));d.displayName="CardTitle";let o=s.forwardRef(({className:e,...r},t)=>a.jsx("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...r}));o.displayName="CardDescription";let c=s.forwardRef(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let u=s.forwardRef(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...r}));u.displayName="CardFooter"},9280:(e,r,t)=>{"use strict";t.d(r,{X:()=>d});var a=t(10326),s=t(17577),n=t(13635),l=t(32933),i=t(51223);let d=s.forwardRef(({className:e,...r},t)=>a.jsx(n.fC,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:a.jsx(n.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:a.jsx(l.Z,{className:"h-4 w-4"})})}));d.displayName=n.fC.displayName},94880:(e,r,t)=>{"use strict";t.d(r,{E:()=>y});var a=t(10326),s=t(17577),n=t(93095),l=t(45226),i="Progress",[d,o]=(0,n.b)(i),[c,u]=d(i),p=s.forwardRef((e,r)=>{var t,s;let{__scopeProgress:n,value:i=null,max:d,getValueLabel:o=m,...u}=e;(d||0===d)&&!g(d)&&console.error((t=`${d}`,`Invalid prop \`max\` of value \`${t}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let p=g(d)?d:100;null===i||b(i,p)||console.error((s=`${i}`,`Invalid prop \`value\` of value \`${s}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let f=b(i,p)?i:null,x=v(f)?o(f,p):void 0;return(0,a.jsx)(c,{scope:n,value:f,max:p,children:(0,a.jsx)(l.WV.div,{"aria-valuemax":p,"aria-valuemin":0,"aria-valuenow":v(f)?f:void 0,"aria-valuetext":x,role:"progressbar","data-state":h(f,p),"data-value":f??void 0,"data-max":p,...u,ref:r})})});p.displayName=i;var f="ProgressIndicator",x=s.forwardRef((e,r)=>{let{__scopeProgress:t,...s}=e,n=u(f,t);return(0,a.jsx)(l.WV.div,{"data-state":h(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...s,ref:r})});function m(e,r){return`${Math.round(e/r*100)}%`}function h(e,r){return null==e?"indeterminate":e===r?"complete":"loading"}function v(e){return"number"==typeof e}function g(e){return v(e)&&!isNaN(e)&&e>0}function b(e,r){return v(e)&&!isNaN(e)&&e<=r&&e>=0}x.displayName=f;var j=t(51223);let y=s.forwardRef(({className:e,value:r,...t},s)=>a.jsx(p,{ref:s,className:(0,j.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...t,children:a.jsx(x,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));y.displayName=p.displayName},11475:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`D:\武欣宇\大三下\计算机设计大赛\StudyPlanner2\src\app\plan\page.tsx#default`)},13635:(e,r,t)=>{"use strict";t.d(r,{fC:()=>k,z$:()=>P});var a=t(17577),s=t(48051),n=t(93095),l=t(82561),i=t(52067),d=t(53405),o=t(2566),c=t(9815),u=t(45226),p=t(10326),f="Checkbox",[x,m]=(0,n.b)(f),[h,v]=x(f),g=a.forwardRef((e,r)=>{let{__scopeCheckbox:t,name:n,checked:d,defaultChecked:o,required:c,disabled:x,value:m="on",onCheckedChange:v,form:g,...b}=e,[j,k]=a.useState(null),P=(0,s.e)(r,e=>k(e)),R=a.useRef(!1),C=!j||g||!!j.closest("form"),[S,D]=(0,i.T)({prop:d,defaultProp:o??!1,onChange:v,caller:f}),E=a.useRef(S);return a.useEffect(()=>{let e=j?.form;if(e){let r=()=>D(E.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[j,D]),(0,p.jsxs)(h,{scope:t,state:S,disabled:x,children:[(0,p.jsx)(u.WV.button,{type:"button",role:"checkbox","aria-checked":N(S)?"mixed":S,"aria-required":c,"data-state":w(S),"data-disabled":x?"":void 0,disabled:x,value:m,...b,ref:P,onKeyDown:(0,l.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.M)(e.onClick,e=>{D(e=>!!N(e)||!e),C&&(R.current=e.isPropagationStopped(),R.current||e.stopPropagation())})}),C&&(0,p.jsx)(y,{control:j,bubbles:!R.current,name:n,value:m,checked:S,required:c,disabled:x,form:g,style:{transform:"translateX(-100%)"},defaultChecked:!N(o)&&o})]})});g.displayName=f;var b="CheckboxIndicator",j=a.forwardRef((e,r)=>{let{__scopeCheckbox:t,forceMount:a,...s}=e,n=v(b,t);return(0,p.jsx)(c.z,{present:a||N(n.state)||!0===n.state,children:(0,p.jsx)(u.WV.span,{"data-state":w(n.state),"data-disabled":n.disabled?"":void 0,...s,ref:r,style:{pointerEvents:"none",...e.style}})})});j.displayName=b;var y=a.forwardRef(({__scopeCheckbox:e,control:r,checked:t,bubbles:n=!0,defaultChecked:l,...i},c)=>{let f=a.useRef(null),x=(0,s.e)(f,c),m=(0,d.D)(t),h=(0,o.t)(r);a.useEffect(()=>{let e=f.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(m!==t&&r){let a=new Event("click",{bubbles:n});e.indeterminate=N(t),r.call(e,!N(t)&&t),e.dispatchEvent(a)}},[m,t,n]);let v=a.useRef(!N(t)&&t);return(0,p.jsx)(u.WV.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??v.current,...i,tabIndex:-1,ref:x,style:{...i.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function N(e){return"indeterminate"===e}function w(e){return N(e)?"indeterminate":e?"checked":"unchecked"}y.displayName="CheckboxBubbleInput";var k=g,P=j},53405:(e,r,t)=>{"use strict";t.d(r,{D:()=>s});var a=t(17577);function s(e){let r=a.useRef({value:e,previous:e});return a.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},2566:(e,r,t)=>{"use strict";t.d(r,{t:()=>n});var a=t(17577),s=t(65819);function n(e){let[r,t]=a.useState(void 0);return(0,s.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let a,s;if(!Array.isArray(r)||!r.length)return;let n=r[0];if("borderBoxSize"in n){let e=n.borderBoxSize,r=Array.isArray(e)?e[0]:e;a=r.inlineSize,s=r.blockSize}else a=e.offsetWidth,s=e.offsetHeight;t({width:a,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}t(void 0)},[e]),r}}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5499,434],()=>t(31699));module.exports=a})();